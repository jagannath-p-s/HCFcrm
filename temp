see the functionalities in import React, { useState } from 'react';
import {
  Card,
  CardContent,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Button } from "@/components/ui/button";
import { Dialog, DialogContent, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Input } from "@/components/ui/input";
import { Pencil, Trash } from "lucide-react";
import { supabase } from '../supabaseClient';  // Make sure to import your Supabase client

function MembershipPlans({ membershipPlans, fetchMembershipPlans, showSnackbar }) {
  const [openPlanDialog, setOpenPlanDialog] = useState(false);
  const [planFormData, setPlanFormData] = useState({
    id: null,
    name: '',
    duration_in_months: '',
    base_price: '',
  });

  // Open dialog for creating or editing a plan
  const handleOpenPlanDialog = (plan = null) => {
    setPlanFormData(
      plan || { id: null, name: '', duration_in_months: '', base_price: '' }
    );
    setOpenPlanDialog(true);
  };

  const handleClosePlanDialog = () => {
    setOpenPlanDialog(false);
  };

  // Handle form change
  const handlePlanFormChange = (e) => {
    const { name, value } = e.target;
    setPlanFormData({ ...planFormData, [name]: value });
  };

  // Handle form submit (add or update)
  const handlePlanFormSubmit = async () => {
    try {
      if (planFormData.id) {
        // Edit an existing plan
        const { error } = await supabase
          .from('membership_plans')
          .update({
            name: planFormData.name,
            duration_in_months: planFormData.duration_in_months,
            base_price: planFormData.base_price,
          })
          .eq('id', planFormData.id);
        if (error) throw error;
        showSnackbar('Plan updated successfully', 'success');
      } else {
        // Add a new plan
        const { error } = await supabase.from('membership_plans').insert({
          name: planFormData.name,
          duration_in_months: planFormData.duration_in_months,
          base_price: planFormData.base_price,
        });
        if (error) throw error;
        showSnackbar('Plan created successfully', 'success');
      }
      fetchMembershipPlans();  // Refresh the list
      handleClosePlanDialog();  // Close the dialog
    } catch (error) {
      showSnackbar('Error saving plan: ' + error.message, 'error');
    }
  };

  // Handle delete
  const handleDeletePlan = async (id) => {
    try {
      const { error } = await supabase
        .from('membership_plans')
        .delete()
        .eq('id', id);
      if (error) throw error;
      showSnackbar('Plan deleted successfully', 'success');
      fetchMembershipPlans();  // Refresh the list
    } catch (error) {
      showSnackbar('Error deleting plan: ' + error.message, 'error');
    }
  };

  return (
    <Card className="mb-4">
      <CardHeader>
        <CardTitle>Membership Plans</CardTitle>
        <Button className="ml-auto" onClick={() => handleOpenPlanDialog()}>Create New Plan</Button>
      </CardHeader>
      <CardContent>
        <Table>
          <TableHeader>
            <TableRow>
              <TableHead>Name</TableHead>
              <TableHead className="text-center">Duration (Months)</TableHead>
              <TableHead className="text-center">Base Price (Rs)</TableHead>
              <TableHead className="text-center">Actions</TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
            {membershipPlans.map((plan) => (
              <TableRow key={plan.id}>
                <TableCell>{plan.name}</TableCell>
                <TableCell className="text-center" >{plan.duration_in_months}</TableCell>
                <TableCell className="text-center">Rs {plan.base_price}</TableCell>
                <TableCell className="text-center">
                  <Button variant="outline" onClick={() => handleOpenPlanDialog(plan)}>
                    <Pencil className="h-4 w-4 mr-2" /> Edit
                  </Button>
                  <Button variant="destructive" onClick={() => handleDeletePlan(plan.id)} className="ml-2">
                    <Trash className="h-4 w-4 mr-2" /> Delete
                  </Button>
                </TableCell>
              </TableRow>
            ))}
          </TableBody>
        </Table>
      </CardContent>

      {/* Plan Dialog */}
      <Dialog open={openPlanDialog} onOpenChange={setOpenPlanDialog}>
        <DialogContent>
          <DialogHeader>
            <DialogTitle>{planFormData.id ? 'Edit Membership Plan' : 'Create Membership Plan'}</DialogTitle>
          </DialogHeader>
          <div className="grid grid-cols-1 gap-4 mt-4">
            <Input
              label="Plan Name"
              placeholder="Enter plan name"
              value={planFormData.name}
              onChange={handlePlanFormChange}
              name="name"
              required
            />
            <Input
              label="Duration (Months)"
              placeholder="Enter duration in months"
              type="number"
              value={planFormData.duration_in_months}
              onChange={handlePlanFormChange}
              name="duration_in_months"
              required
            />
            <Input
              label="Base Price (Rs)"
              placeholder="Enter base price"
              type="number"
              value={planFormData.base_price}
              onChange={handlePlanFormChange}
              name="base_price"
              required
            />
          </div>
          <div className="flex justify-end mt-4">
            <Button variant="outline" onClick={handleClosePlanDialog}>Cancel</Button>
            <Button className="ml-4" onClick={handlePlanFormSubmit}>
              {planFormData.id ? 'Save Changes' : 'Create Plan'}
            </Button>
          </div>
        </DialogContent>
      </Dialog>
    </Card>
  );
}

export default MembershipPlans; , i want to create such a component for madding memberships , when meberships are added or edited income should chnage accordingly , the tables i have are , create table
  public.memberships (
    id serial not null,
    user_id integer not null,
    admission_plan_id integer null,
    membership_plan_id integer null,
    additional_service_plan_id integer null,
    payment_mode_id integer not null,
    start_date date not null,
    end_date date not null,
    admission_or_renewal_fee numeric not null default 0,
    plan_fee numeric not null default 0,
    additional_fee numeric not null default 0,
    total_amount numeric not null,
    remarks text null,
    created_at timestamp with time zone null default now(),
    payment_date date null,
    constraint memberships_pkey primary key (id),
    constraint memberships_additional_service_plan_id_fkey foreign key (additional_service_plan_id) references membership_plans (id),
    constraint memberships_admission_plan_id_fkey foreign key (admission_plan_id) references membership_plans (id),
    constraint memberships_membership_plan_id_fkey foreign key (membership_plan_id) references membership_plans (id),
    constraint memberships_payment_mode_id_fkey foreign key (payment_mode_id) references payment_modes (id),
    constraint memberships_user_id_fkey foreign key (user_id) references users (id)
  ) tablespace pg_default; , create table
  public.membership_plans (
    id serial not null,
    name text not null,
    duration_in_days integer null,
    base_price numeric not null,
    type text not null,
    class_type text null,
    additional_services text null,
    created_at timestamp with time zone null default now(),
    number_of_people integer null,
    constraint membership_plans_pkey primary key (id)
  ) tablespace pg_default; , create table
  public.users (
    id serial not null,
    user_id text not null,
    name character varying(255) not null,
    email character varying(255) not null,
    date_of_birth date null,
    blood_group character varying null,
    medical_conditions text null,
    created_at timestamp with time zone not null,
    updated_at timestamp with time zone null,
    mobile_number_1 text not null,
    active boolean null default false,
    subscription_end date null,
    mobile_number_2 character varying(15) null,
    emergency_contact_number character varying(15) null,
    allergies text null,
    injuries text null,
    current_medications text null,
    fitness_goals text null,
    role character varying(50) null,
    constraint users_pkey primary key (id),
    constraint users_email_unique unique (email),
    constraint users_user_id_key unique (user_id)
  ) tablespace pg_default;

  fix and give full code for the new table remeber that the Membership Plan and might have 